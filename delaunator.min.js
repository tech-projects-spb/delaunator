!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";const t=Math.pow(2,-52),i=new Uint32Array(512),{orient2d:s}=require("robust-predicates");class e{static from(t,i=o,s=_){const h=t.length,n=new Float64Array(2*h);for(let e=0;e<h;e++){const h=t[e];n[2*e]=i(h),n[2*e+1]=s(h)}return new e(n)}constructor(t){const i=t.length>>1;if(i>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const s=Math.max(2*i-5,0);this._triangles=new Uint32Array(3*s),this._halfedges=new Int32Array(3*s),this._hashSize=Math.ceil(Math.sqrt(i)),this._hullPrev=new Uint32Array(i),this._hullNext=new Uint32Array(i),this._hullTri=new Uint32Array(i),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(i),this._dists=new Float64Array(i),this.update()}update(){const{coords:i,_hullPrev:e,_hullNext:n,_hullTri:a,_hullHash:o}=this,_=i.length>>1;let c=1/0,f=1/0,u=-1/0,d=-1/0;for(let t=0;t<_;t++){const s=i[2*t],e=i[2*t+1];s<c&&(c=s),e<f&&(f=e),s>u&&(u=s),e>d&&(d=e),this._ids[t]=t}const g=(c+u)/2,y=(f+d)/2;let w,b,A,k=1/0;for(let t=0;t<_;t++){const s=h(g,y,i[2*t],i[2*t+1]);s<k&&(w=t,k=s)}const S=i[2*w],x=i[2*w+1];k=1/0;for(let t=0;t<_;t++){if(t===w)continue;const s=h(S,x,i[2*t],i[2*t+1]);s<k&&s>0&&(b=t,k=s)}let z=i[2*b],U=i[2*b+1],M=1/0;for(let t=0;t<_;t++){if(t===w||t===b)continue;const s=r(S,x,z,U,i[2*t],i[2*t+1]);s<M&&(A=t,M=s)}let T=i[2*A],p=i[2*A+1];if(M===1/0){for(let t=0;t<_;t++)this._dists[t]=i[2*t]-i[0]||i[2*t+1]-i[1];l(this._ids,this._dists,0,_-1);const t=new Uint32Array(_);let s=0;for(let i=0,e=-1/0;i<_;i++){const h=this._ids[i];this._dists[h]>e&&(t[s++]=h,e=this._dists[h])}return this.hull=t.subarray(0,s),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(s(S,x,z,U,T,p)<0){const t=b,i=z,s=U;b=A,z=T,U=p,A=t,T=i,p=s}const K=function(t,i,s,e,h,n){const r=s-t,l=e-i,a=h-t,o=n-i,_=r*r+l*l,c=a*a+o*o,f=.5/(r*o-l*a);return{x:t+(o*_-l*c)*f,y:i+(r*c-a*_)*f}}(S,x,z,U,T,p);this._cx=K.x,this._cy=K.y;for(let t=0;t<_;t++)this._dists[t]=h(i[2*t],i[2*t+1],K.x,K.y);l(this._ids,this._dists,0,_-1),this._hullStart=w;let m=3;n[w]=e[A]=b,n[b]=e[w]=A,n[A]=e[b]=w,a[w]=0,a[b]=1,a[A]=2,o.fill(-1),o[this._hashKey(S,x)]=w,o[this._hashKey(z,U)]=b,o[this._hashKey(T,p)]=A,this.trianglesLen=0,this._addTriangle(w,b,A,-1,-1,-1);for(let h,r,l=0;l<this._ids.length;l++){const _=this._ids[l],c=i[2*_],f=i[2*_+1];if(l>0&&Math.abs(c-h)<=t&&Math.abs(f-r)<=t)continue;if(h=c,r=f,_===w||_===b||_===A)continue;let u=0;for(let t=0,i=this._hashKey(c,f);t<this._hashSize&&(u=o[(i+t)%this._hashSize],-1===u||u===n[u]);t++);u=e[u];let d,g=u;for(;d=n[g],s(c,f,i[2*g],i[2*g+1],i[2*d],i[2*d+1])>=0;)if(g=d,g===u){g=-1;break}if(-1===g)continue;let y=this._addTriangle(g,_,n[g],-1,-1,a[g]);a[_]=this._legalize(y+2),a[g]=y,m++;let k=n[g];for(;d=n[k],s(c,f,i[2*k],i[2*k+1],i[2*d],i[2*d+1])<0;)y=this._addTriangle(k,_,d,a[_],-1,a[k]),a[_]=this._legalize(y+2),n[k]=k,m--,k=d;if(g===u)for(;d=e[g],s(c,f,i[2*d],i[2*d+1],i[2*g],i[2*g+1])<0;)y=this._addTriangle(d,_,g,-1,a[g],a[d]),this._legalize(y+2),a[d]=y,n[g]=g,m--,g=d;this._hullStart=e[_]=g,n[g]=e[k]=_,n[_]=k,o[this._hashKey(c,f)]=_,o[this._hashKey(i[2*g],i[2*g+1])]=g}this.hull=new Uint32Array(m);for(let t=0,i=this._hullStart;t<m;t++)this.hull[t]=i,i=n[i];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,i){return Math.floor(function(t,i){const s=t/(Math.abs(t)+Math.abs(i));return(i>0?3-s:1+s)/4}(t-this._cx,i-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:s,_halfedges:e,coords:h}=this;let r=0,l=0;for(;;){const a=e[t],o=t-t%3;if(l=o+(t+2)%3,-1===a){if(0===r)break;t=i[--r];continue}const _=a-a%3,c=o+(t+1)%3,f=_+(a+2)%3,u=s[l],d=s[t],g=s[c],y=s[f];if(n(h[2*u],h[2*u+1],h[2*d],h[2*d+1],h[2*g],h[2*g+1],h[2*y],h[2*y+1])){s[t]=y,s[a]=u;const h=e[f];if(-1===h){let i=this._hullStart;do{if(this._hullTri[i]===f){this._hullTri[i]=t;break}i=this._hullPrev[i]}while(i!==this._hullStart)}this._link(t,h),this._link(a,e[l]),this._link(l,f);const n=_+(a+1)%3;r<i.length&&(i[r++]=n)}else{if(0===r)break;t=i[--r]}}return l}_link(t,i){this._halfedges[t]=i,-1!==i&&(this._halfedges[i]=t)}_addTriangle(t,i,s,e,h,n){const r=this.trianglesLen;return this._triangles[r]=t,this._triangles[r+1]=i,this._triangles[r+2]=s,this._link(r,e),this._link(r+1,h),this._link(r+2,n),this.trianglesLen+=3,r}}function h(t,i,s,e){const h=t-s,n=i-e;return h*h+n*n}function n(t,i,s,e,h,n,r,l){const a=t-r,o=i-l,_=s-r,c=e-l,f=h-r,u=n-l,d=_*_+c*c,g=f*f+u*u;return a*(c*g-d*u)-o*(_*g-d*f)+(a*a+o*o)*(_*u-c*f)<0}function r(t,i,s,e,h,n){const r=s-t,l=e-i,a=h-t,o=n-i,_=r*r+l*l,c=a*a+o*o,f=.5/(r*o-l*a),u=(o*_-l*c)*f,d=(r*c-a*_)*f;return u*u+d*d}function l(t,i,s,e){if(e-s<=20)for(let h=s+1;h<=e;h++){const e=t[h],n=i[e];let r=h-1;for(;r>=s&&i[t[r]]>n;)t[r+1]=t[r--];t[r+1]=e}else{let h=s+1,n=e;a(t,s+e>>1,h),i[t[s]]>i[t[e]]&&a(t,s,e),i[t[h]]>i[t[e]]&&a(t,h,e),i[t[s]]>i[t[h]]&&a(t,s,h);const r=t[h],o=i[r];for(;;){do{h++}while(i[t[h]]<o);do{n--}while(i[t[n]]>o);if(n<h)break;a(t,h,n)}t[s+1]=t[n],t[n]=r,e-h+1>=n-s?(l(t,i,h,e),l(t,i,s,n-1)):(l(t,i,s,n-1),l(t,i,h,e))}}function a(t,i,s){const e=t[i];t[i]=t[s],t[s]=e}function o(t){return t[0]}function _(t){return t[1]}module.exports={Delaunator:e}}));
